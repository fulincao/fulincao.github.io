<p>匈牙利算法是由匈牙利数学家Edmonds于1965年提出，因而得名。本质是为了解决二分图匹配问题。大致理解如下:<br />
有n个男的，m个女的。男的只能跟女的配对，且只能一对一配对。同时，如果男女配对需要消耗彩礼cost，不同男女之间的彩礼是不一样的。问如何尽可能的配对，同时配对所消耗的彩礼最小。匈牙利本质就是解决这种问题。具体可以看<a href="https://blog.csdn.net/sunny_hun/article/details/80627351">匈牙利算法详解</a>,此算法常用于<strong>目标关联，目标融合，目标匹配</strong>等场景。本文主要记录如何实现。</p>

<h3 id="cost相同尽可能匹配多">cost相同，尽可能匹配多</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;bits/stdc++.h&gt;
#define INF 0x3f3f3f3f;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">L</span><span class="p">[</span><span class="mi">505</span><span class="p">][</span><span class="mi">505</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">boy</span><span class="p">[</span><span class="mi">505</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">used</span><span class="p">[</span><span class="mi">505</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">k</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">;</span>  <span class="c1">//可能的组合数k，女生数m，男生数n </span>

<span class="c1">// 二分图匹配 </span>
<span class="kt">bool</span> <span class="nf">find</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">used</span><span class="p">[</span><span class="n">j</span><span class="p">]){</span>  <span class="c1">//跟他有关系而且没有搜索过 </span>
            <span class="n">used</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">boy</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">||</span> <span class="n">find</span><span class="p">(</span><span class="n">boy</span><span class="p">[</span><span class="n">j</span><span class="p">])){</span>
                <span class="n">boy</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">k</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">){</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">L</span><span class="p">));</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">boy</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">boy</span><span class="p">));</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">k</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">;</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n1</span><span class="o">&gt;&gt;</span><span class="n">n2</span><span class="p">;</span>
            <span class="n">L</span><span class="p">[</span><span class="n">n1</span><span class="p">][</span><span class="n">n2</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="kt">int</span> <span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="n">memset</span><span class="p">(</span><span class="n">used</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">used</span><span class="p">));</span>
            <span class="k">if</span><span class="p">(</span><span class="n">find</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="n">sum</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">sum</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> 

</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="cost不同尽可能cost最小递归方法">cost不同，尽可能cost最小，递归方法</h3>
<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
</pre></td><td class="rouge-code"><pre><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">INF</span> <span class="o">=</span> <span class="mh">0x3f3f3f3f</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">love</span><span class="p">[</span><span class="mi">305</span><span class="p">][</span><span class="mi">305</span><span class="p">];</span>    <span class="c1">// 每个妹子对每个男生的好感度 </span>
<span class="kt">int</span> <span class="n">ex_girl</span><span class="p">[</span><span class="mi">305</span><span class="p">];</span>      <span class="c1">// 每个妹子的期望值</span>
<span class="kt">int</span> <span class="n">ex_boy</span><span class="p">[</span><span class="mi">305</span><span class="p">];</span>       <span class="c1">// 每个男生的期望值</span>
<span class="kt">bool</span> <span class="n">vis_girl</span><span class="p">[</span><span class="mi">305</span><span class="p">];</span>    <span class="c1">// 每一轮匹配匹配过的女生</span>
<span class="kt">bool</span> <span class="n">vis_boy</span><span class="p">[</span><span class="mi">305</span><span class="p">];</span>     <span class="c1">// 每一轮匹配匹配过的男生</span>
<span class="kt">int</span> <span class="n">match</span><span class="p">[</span><span class="mi">305</span><span class="p">];</span>        <span class="c1">// 每个男生匹配到的妹子 如果没有则为-1</span>
<span class="kt">int</span> <span class="n">slack</span><span class="p">[</span><span class="mi">305</span><span class="p">];</span>        <span class="c1">// 每个汉子如果能被妹子倾心最少还需要多少期望值</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">;</span>

<span class="kt">bool</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">girl</span><span class="p">){</span>
    <span class="n">vis_girl</span><span class="p">[</span><span class="n">girl</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">boy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">boy</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">boy</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vis_boy</span><span class="p">[</span><span class="n">boy</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span> <span class="c1">// 每一轮匹配 每个男生只尝试一次</span>
        <span class="kt">int</span> <span class="n">gap</span> <span class="o">=</span> <span class="n">ex_girl</span><span class="p">[</span><span class="n">girl</span><span class="p">]</span> <span class="o">+</span> <span class="n">ex_boy</span><span class="p">[</span><span class="n">boy</span><span class="p">]</span> <span class="o">-</span> <span class="n">love</span><span class="p">[</span><span class="n">girl</span><span class="p">][</span><span class="n">boy</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">gap</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// 如果符合要求</span>
            <span class="n">vis_boy</span><span class="p">[</span><span class="n">boy</span><span class="p">]</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">match</span><span class="p">[</span><span class="n">boy</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="n">dfs</span><span class="p">(</span> <span class="n">match</span><span class="p">[</span><span class="n">boy</span><span class="p">]</span> <span class="p">))</span> <span class="p">{</span>    <span class="c1">// 找到一个没有匹配的男生 或者该男生的妹子可以找到其他人</span>
                <span class="n">match</span><span class="p">[</span><span class="n">boy</span><span class="p">]</span> <span class="o">=</span> <span class="n">girl</span><span class="p">;</span>
                <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="n">slack</span><span class="p">[</span><span class="n">boy</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">slack</span><span class="p">[</span><span class="n">boy</span><span class="p">],</span> <span class="n">gap</span><span class="p">);</span>  <span class="c1">// slack 可以理解为该男生要得到女生的倾心 还需多少期望值 取最小值 备胎的样子</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">KM</span><span class="p">(){</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">match</span><span class="p">);</span>    <span class="c1">// 初始每个男生都没有匹配的女生</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">ex_boy</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">ex_boy</span><span class="p">);</span>   <span class="c1">// 初始每个男生的期望值为0</span>
    <span class="c1">// 每个女生的初始期望值是与她相连的男生最大的好感度</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ex_girl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">love</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ex_girl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">ex_girl</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">love</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// 尝试为每一个女生解决归宿问题</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fill</span><span class="p">(</span><span class="n">slack</span><span class="p">,</span> <span class="n">slack</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="n">INF</span><span class="p">);</span>    <span class="c1">// 因为要取最小值 初始化为无穷大</span>
        <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
            <span class="c1">// 为每个女生解决归宿问题的方法是 ：如果找不到就降低期望值，直到找到为止</span>
            <span class="c1">// 记录每轮匹配中男生女生是否被尝试匹配过</span>
            <span class="n">memset</span><span class="p">(</span><span class="n">vis_girl</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">vis_girl</span><span class="p">);</span>
            <span class="n">memset</span><span class="p">(</span><span class="n">vis_boy</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="k">sizeof</span> <span class="n">vis_boy</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">break</span><span class="p">;</span>  <span class="c1">// 找到归宿 退出</span>
            <span class="c1">// 如果不能找到 就降低期望值</span>
            <span class="c1">// 最小可降低的期望值</span>
            <span class="kt">int</span> <span class="n">d</span> <span class="o">=</span> <span class="n">INF</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">vis_boy</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>    <span class="n">d</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">slack</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// 所有访问过的女生降低期望值</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">vis_girl</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">ex_girl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">d</span><span class="p">;</span>
                <span class="c1">// 所有访问过的男生增加期望值</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">vis_boy</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">ex_boy</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">d</span><span class="p">;</span>
                <span class="c1">// 没有访问过的boy 因为girl们的期望值降低，距离得到女生倾心又进了一步！</span>
                <span class="k">else</span> <span class="n">slack</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">d</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// 匹配完成 求出所有配对的好感度的和</span>
    <span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="n">love</span><span class="p">[</span><span class="n">match</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">i</span><span class="p">];</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
                <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">love</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">KM</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>        

</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="cost不同尽可能cost最小矩阵方法">cost不同，尽可能cost最小，矩阵方法</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
</pre></td><td class="rouge-code"><pre>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">class</span> <span class="nc">Munkres</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cost</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">inv_eps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="bp">None</span><span class="p">:</span>
        <span class="s">"""[summary]
        https://brc2.com/the-algorithm-workshop/
        Args:
            cost (list): [二维权值方阵]
        """</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">cost</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">inv_eps</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">cost</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int32</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">cost</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cost</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">running</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">assert</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span> <span class="o">==</span> <span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">mp</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">step_one</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">step_two</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">step_three</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">step_four</span><span class="p">,</span>
            <span class="mi">5</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">step_five</span><span class="p">,</span>
            <span class="mi">6</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">step_six</span><span class="p">,</span>
            <span class="mi">7</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">step_seven</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">)</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">paths</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">step_one</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""[summary]
            For each row of the matrix, find the smallest element and subtract it from every element in its row.  Go to Step 2
        """</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">step_two</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""[summary]
        Find a zero (Z) in the resulting matrix. If there is no starred zero in its row or column, star Z. Repeat for each element in the matrix. Go to Step 3
        """</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">step_three</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""[summary]
            Cover each column containing a starred zero.  
            If K columns are covered, the starred zeros describe a complete set of unique assignments.  
            In this case, Go to DONE, otherwise, Go to Step 4.
        """</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">colcount</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colcount</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">rows</span> <span class="ow">or</span> <span class="n">colcount</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">7</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="k">def</span> <span class="nf">__find_a_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""[summary]
         Find a noncovered zero
        Returns:
            [type]: [row, col , default -1]
        """</span>
        <span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>
        <span class="k">return</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span>

    <span class="k">def</span> <span class="nf">__find_star_in_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="s">"""[summary]

        Args:
            row ([type]): [row]

        Returns:
            [int]: [find stared col in row, default -1]
        """</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">j</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">step_four</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""[summary]
            Find a noncovered zero and prime it.  If there is no starred zero in the row containing this primed zero, Go to Step 5.  
            Otherwise, cover this row and uncover the column containing the starred zero. 
            Continue in this manner until there are no uncovered zeros left. Save the smallest uncovered value and Go to Step 6.
        """</span>
        <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">noncover_r</span><span class="p">,</span> <span class="n">noncover_c</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__find_a_zero</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">noncover_r</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">6</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">noncover_r</span><span class="p">][</span><span class="n">noncover_c</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
                <span class="n">star_col</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__find_star_in_row</span><span class="p">(</span><span class="n">noncover_r</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">star_col</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">noncover_r</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">star_col</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">5</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">.</span><span class="n">append</span><span class="p">((</span><span class="n">noncover_r</span><span class="p">,</span> <span class="n">noncover_c</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__find_star_in_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">i</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__find_prime_in_row</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="s">"""[summary]
        Args:
            col ([type]): [col]
        Returns:
            [int]: [find prime row in col, default -1]
        """</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">j</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">step_five</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""[summary]
            Construct a series of alternating primed and starred zeros as follows.  Let Z0 represent the uncovered primed zero found in Step 4. 
            Let Z1 denote the starred zero in the column of Z0 (if any). Let Z2 denote the primed zero in the row of Z1 (there will always be one).  
            Continue until the series terminates at a primed zero that has no starred zero in its column. 
            Unstar each starred zero of the series, star each primed zero of the series, erase all primes and uncover every line in the matrix.  Return to Step 3
        """</span>
        
        <span class="n">done</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
            <span class="n">star_r</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__find_star_in_col</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">star_r</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">star_r</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">done</span> <span class="o">=</span> <span class="bp">True</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">done</span><span class="p">:</span>
                <span class="n">prime_c</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">__find_prime_in_row</span><span class="p">(</span> <span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">prime_c</span><span class="p">))</span>

        <span class="c1"># argument path
</span>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># clear covers
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># erase prime
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">paths</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">step_six</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">"""[summary]
            Add the value found in Step 4 to every element of each covered row, and subtract it from every element of each uncovered column.  
            Return to Step 4 without altering any stars, primes, or covered lines
        """</span>
        <span class="n">minval</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">31</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">minval</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">minval</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">row_cover</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">minval</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">col_cover</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="p">.</span><span class="n">run_cost</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="n">minval</span>

        <span class="bp">self</span><span class="p">.</span><span class="n">step</span> <span class="o">=</span> <span class="mi">4</span>


    <span class="k">def</span> <span class="nf">step_seven</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># print("done !")
</span>        <span class="c1"># print(self.run_cost)
</span>        <span class="c1"># print(self.mask)
</span>        <span class="bp">self</span><span class="p">.</span><span class="n">running</span> <span class="o">=</span> <span class="bp">False</span>


    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="p">.</span><span class="n">running</span><span class="p">:</span>
            <span class="c1"># print(self.step)
</span>            <span class="bp">self</span><span class="p">.</span><span class="n">mp</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">step</span><span class="p">]()</span>
            <span class="c1"># print(self.run_cost)
</span>            <span class="c1"># print("")
</span>
    <span class="k">def</span> <span class="nf">get_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">cols</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">cols</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">.</span><span class="n">rows</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"algorithm error ..."</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="n">res</span>

<span class="k">if</span>  <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="n">cost</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]]</span>
    <span class="n">mkr</span> <span class="o">=</span> <span class="n">Munkres</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
    <span class="n">mkr</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">mkr</span><span class="p">.</span><span class="n">get_result</span><span class="p">())</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<p>以上三种方式中，第三种广泛使用目标关联中。其具体原理见<a href="https://brc2.com/the-algorithm-workshop/">Munkres’ Assignment Algorithm</a></p>
